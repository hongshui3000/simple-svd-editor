import { Meta, Story, Canvas } from '@storybook/addon-docs/blocks';
import { action } from '@storybook/addon-actions';
import * as Yup from 'yup';
import { Button, scale, baseTheme } from '@scripts/gds';
import Form from '@components/controls/Form';
import StarIcon from '@icons/star.svg';
import Select from '.';

<Meta title="Controls / Form / Select" component={Select} />

# Select

<Story
    name="Controls"
    args={{
        label: '–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç',
        simple: false,
        hint: '–¢–µ–∫—Å—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏',
        required: true,
        placeholder: '–í—ã–±–µ—Ä–∏ –º–µ–Ω—è...',
        heightProp: scale(4),
        isLegend: true,
        disabled: false,
        items: [
            { value: 'value1', label: '–í–∞—Ä–∏–∞–Ω—Ç 1' },
            { value: 'value2', label: '–í–∞—Ä–∏–∞–Ω—Ç 2' },
            { value: 'value3', label: '–í–∞—Ä–∏–∞–Ω—Ç 3' },
            { value: 'value4', label: '–í–∞—Ä–∏–∞–Ω—Ç 4' },
            { value: 'value5', label: '–í–∞—Ä–∏–∞–Ω—Ç 5' },
            {
                value: 'value6',
                label: (
                    <>
                        <StarIcon style={{ marginRight: scale(1) }} fill={baseTheme.colors.brand} />
                        <strong>–í–∞—Ä–∏–∞–Ω—Ç 6</strong>
                    </>
                ),
            },
        ],
    }}
>
    {args => (
        <Form
            initialValues={{ select: '' }}
            validationSchema={Yup.object().shape({
                select: Yup.string().required('–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç'),
            })}
            onSubmit={vals => alert(JSON.stringify(vals))}
            style={{ width: 500 }}
        >
            <Form.Field name="select">
                <Select onChange={action('onChange')} {...args} />
            </Form.Field>
            <br />
            <Form.Reset theme="fill">–°–±—Ä–æ—Å–∏—Ç—å</Form.Reset>
            <Button type="submit">Submit</Button>
        </Form>
    )}
</Story>

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–ª–∞–≥–∏–Ω: [Downshift](https://github.com/downshift-js/downshift), –∞ –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ [useCombobox](https://github.com/downshift-js/downshift/tree/master/src/hooks/useCombobox) –∏ [useSelect](https://github.com/downshift-js/downshift/tree/master/src/hooks/useSelect).

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: [WAI-ARIA](https://www.w3.org/TR/wai-aria-practices/#Listbox).

`Select` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–∞—Å—Ç–æ–º–Ω—ã–π –æ–¥–∏–Ω–æ—á–Ω—ã–π —Å–µ–ª–µ–∫—Ç. –ü–æ–¥ –∫–∞—Å—Ç–æ–º–Ω—ã–º –ø–æ–Ω–∏–º–∞–µ—Ç—Å—è, —á—Ç–æ –æ–Ω –≤–æ–æ–±—â–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–≥ select, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –≥–∏–±–∫–æ–π —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏, –Ω–æ —Ç.–∫. –æ–Ω –ø–æ –≤—Å–µ–º –ø—É–Ω–∫—Ç–∞–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ç–æ –º–æ–∂–Ω–æ –Ω–µ –≤–æ–ª–Ω–æ–≤–∞—Ç—å—Å—è –Ω–∞ —ç—Ç–æ—Ç —Å—á—ë—Ç.

–°–µ–ª–µ–∫—Ç—ã –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ `downshift` - –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –ö–µ–Ω—Ç–∞ –î–æ–¥–¥—Å–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –æ–Ω –≤–æ–ø–ª–æ—Ç–∏–ª –≤—Å–µ —Å–≤–æ–∏ –Ω–∞–≤—ã–∫–∏ React –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

–ö–∞—Å—Ç–æ–º–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä –≤ React –¥–µ–ª–∞–µ—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–æ, —Ç.–∫. –º—ã –º–æ–∂–µ–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ label –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Å–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç. –ú–æ–∂–Ω–æ **–≤–æ–æ–±—â–µ –≤—Å—ë** üòÆ

–ü—Ä–æ–ø–æ–º simple —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫–∞—è –ª–æ–≥–∏–∫–∞ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å—Å—è useSelect –∏–ª–∏ useCombobox. useSelect —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ª–æ–≥–∏–∫—É, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –ø—Ä–æ—Å—Ç–æ–º—É select'—É. useCombobox –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞, —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—è —Å –≤–≤–µ–¥–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π.
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é simple = false

‚òùüèø –î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Å–µ–ª–µ–∫—Ç–∞ –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–Ω–æ–ø–∫–∞, –∞ —Å –Ω–µ–π –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∏–Ω–ø—É—Ç–∞ –Ω–µ–ª—å–∑—è —Å–≤—è–∑—ã–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ label, –ø–æ—ç—Ç–æ–º—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ label –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è div —Å–æ —Å–≤—è–∑–∫–æ–π –ø–æ aria-labelledby. –ü—Ä–∏ —ç—Ç–æ–º aria-–∞—Ç—Ä–∏–±—É—Ç—ã –ø–æ–ª—É—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ props getters –∏–∑ downshift, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏—à–ª–æ—Å—å –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –æ–±—ë—Ä—Ç–∫–∏ –≤ Form.Field –∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞—Ç—å label –Ω–∞–ø—Ä—è–º—É—é (–º—ã –Ω–µ –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å —ç—Ç–∏ –ø—Ä–æ–ø—Å—ã —Å–Ω–∞—Ä—É–∂–∏).

‚ùóÔ∏è –ü—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –≤ item.label –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –ø–æ–∏—Å–∫ –∏–¥—ë—Ç –ø–æ value –≤–º–µ—Å—Ç–æ label. –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∏–¥–µ—è –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, —Ç–æ —ç—Ç–æ –±—ã–ª –±—ã –æ—Ç–ª–∏—á–Ω—ã–π pull request üòâ

## Use Cases

### W/O search

<Canvas>
    <Story name="Without search">
        <Form
            initialValues={{ select: '' }}
            validationSchema={Yup.object().shape({
                select: Yup.string().required('–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç'),
            })}
            onSubmit={vals => alert(JSON.stringify(vals))}
            style={{ width: 500 }}
        >
            <Form.Field name="select">
                <Select
                    simple
                    label="–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç"
                    hint="–¢–µ–∫—Å—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏"
                    items={[
                        { value: 'value1', label: '–í–∞—Ä–∏–∞–Ω—Ç 1' },
                        { value: 'value2', label: '–í–∞—Ä–∏–∞–Ω—Ç 2' },
                        { value: 'value3', label: '–í–∞—Ä–∏–∞–Ω—Ç 3' },
                        { value: 'value4', label: '–í–∞—Ä–∏–∞–Ω—Ç 4' },
                        { value: 'value5', label: '–í–∞—Ä–∏–∞–Ω—Ç 5' },
                        {
                            value: 'value6',
                            label: (
                                <>
                                    <StarIcon
                                        width={scale(3)}
                                        height={scale(3)}
                                        style={{ marginRight: scale(1) }}
                                        fill={baseTheme.colors.brand}
                                    />
                                    <strong>–í–∞—Ä–∏–∞–Ω—Ç 6</strong>
                                </>
                            ),
                        },
                    ]}
                    onChange={action('onChange')}
                />
            </Form.Field>
            <br />
            <Form.Reset theme="fill">–°–±—Ä–æ—Å–∏—Ç—å</Form.Reset>
            <Button type="submit">Submit</Button>
        </Form>
    </Story>
</Canvas>

### W/O form

<Canvas>
    <Story name="Without form">
        <Select
            simple
            label="–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç"
            hint="–¢–µ–∫—Å—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏"
            items={[
                { value: 'value1', label: '–í–∞—Ä–∏–∞–Ω—Ç 1' },
                { value: 'value2', label: '–í–∞—Ä–∏–∞–Ω—Ç 2' },
                { value: 'value3', label: '–í–∞—Ä–∏–∞–Ω—Ç 3' },
                { value: 'value4', label: '–í–∞—Ä–∏–∞–Ω—Ç 4' },
                { value: 'value5', label: '–í–∞—Ä–∏–∞–Ω—Ç 5' },
            ]}
            onChange={action('onChange')}
            style={{ width: 500 }}
        />
    </Story>
</Canvas>
